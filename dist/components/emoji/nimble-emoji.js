'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _objectGetPrototypeOf=require('../../polyfills/objectGetPrototypeOf');var _objectGetPrototypeOf2=_interopRequireDefault(_objectGetPrototypeOf);var _classCallCheck2=require('babel-runtime/helpers/classCallCheck');var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require('../../polyfills/createClass');var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require('../../polyfills/possibleConstructorReturn');var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require('../../polyfills/inherits');var _inherits3=_interopRequireDefault(_inherits2);var _react=require('react');var _react2=_interopRequireDefault(_react);var _propTypes=require('prop-types');var _propTypes2=_interopRequireDefault(_propTypes);var _reactNative=require('react-native');var _utils=require('../../utils');var _data=require('../../utils/data');var _sharedProps=require('../../utils/shared-props');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var styles=_reactNative.StyleSheet.create({emojiWrapper:{overflow:'hidden'},labelStyle:{textAlign:'center',color:'#ae65c5'}});var NimbleEmoji=function(_React$PureComponent){(0,_inherits3.default)(NimbleEmoji,_React$PureComponent);function NimbleEmoji(){var _ref;var _temp,_this,_ret;(0,_classCallCheck3.default)(this,NimbleEmoji);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=(0,_possibleConstructorReturn3.default)(this,(_ref=NimbleEmoji.__proto__||(0,_objectGetPrototypeOf2.default)(NimbleEmoji)).call.apply(_ref,[this].concat(args))),_this),_this._getImage=function(data){var image=data.image;var _this$props=_this.props;var skin=_this$props.skin;var set=_this$props.set;var useLocalImages=_this$props.useLocalImages;var emoji=_this._getSanitizedData(_this.props);var imageSource={uri:'https://unpkg.com/emoji-datasource-'+set+'@'+'4.0.4'+'/img/'+set+'/64/'+image};if(useLocalImages&&useLocalImages[emoji.id]){return useLocalImages[emoji.id].localImages[set][(skin||NimbleEmoji.defaultProps.skin)-1];}return imageSource;},_this._getData=function(props){var emoji=props.emoji;var skin=props.skin;var set=props.set;var data=props.data;return(0,_utils.getData)(emoji,skin,set,data);},_this._getSanitizedData=function(props){var emoji=props.emoji;var skin=props.skin;var set=props.set;var data=props.data;return(0,_utils.getSanitizedData)(emoji,skin,set,data);},_this._handlePress=function(e){var onPress=_this.props.onPress;if(!onPress){return;}var emoji=_this._getSanitizedData(_this.props);onPress(emoji,e);},_this._handleLongPress=function(e){var onLongPress=_this.props.onLongPress;if(!onLongPress){return;}var emoji=_this._getSanitizedData(_this.props);onLongPress(emoji,e);},_temp),(0,_possibleConstructorReturn3.default)(_this,_ret);}(0,_createClass3.default)(NimbleEmoji,[{key:'render',value:function render(){if(this.props.data.compressed){(0,_data.uncompress)(this.props.data);}for(var k in NimbleEmoji.defaultProps){if(this.props[k]===undefined&&NimbleEmoji.defaultProps[k]!=undefined){this.props[k]=NimbleEmoji.defaultProps[k];}}var data=this._getData(this.props);if(!data){return null;}var unified=data.unified;var custom=data.custom;var short_names=data.short_names;var imageUrl=data.imageUrl;var style={};var imageStyle={};var labelStyle={};var children=this.props.children;var title=null;var emojiImage=void 0;if(!unified&&!custom){return null;}if(this.props.tooltip){title=short_names[0];}if(this.props.native&&unified){var fontSize=this.props.size;labelStyle={fontSize:fontSize};children=(0,_utils.unifiedToNative)(unified);style.width=this.props.size+this.props.margin;style.height=this.props.size+this.props.margin;}else if(custom){style={width:this.props.size,height:this.props.size,margin:this.props.noMargin?0:this.props.margin/2};imageStyle={width:this.props.size,height:this.props.size};emojiImage=_react2.default.createElement(_reactNative.Image,{style:imageStyle,source:{uri:imageUrl}});}else{var setHasEmoji=data['has_img_'+this.props.set]==undefined||data['has_img_'+this.props.set];if(!setHasEmoji){if(this.props.fallback){return this.props.fallback(data);}else{return null;}}style={width:this.props.size,height:this.props.size,margin:this.props.noMargin?0:this.props.margin/2};var emojiImageFile=this._getImage(data);imageStyle={width:this.props.size,height:this.props.size};emojiImage=_react2.default.createElement(_reactNative.Image,{style:imageStyle,source:this.props.emojiImageFn(emojiImageFile)});}var emojiComponent=_react2.default.createElement(_reactNative.View,{style:[styles.emojiWrapper,style]},emojiImage||_react2.default.createElement(_reactNative.Text,{style:[styles.labelStyle,labelStyle]},children));return this.props.onPress||this.props.onLongPress?_react2.default.createElement(_reactNative.TouchableWithoutFeedback,{onPress:this._handlePress,onLongPress:this._handleLongPress},emojiComponent):emojiComponent;}}]);return NimbleEmoji;}(_react2.default.PureComponent);NimbleEmoji.defaultProps=_sharedProps.EmojiDefaultProps;exports.default=NimbleEmoji;